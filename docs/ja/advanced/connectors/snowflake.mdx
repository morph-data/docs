---
title: "Snowflake"
---

## Snowflake ã«æ¥ç¶šã™ã‚‹

ã‚³ãƒã‚¯ã‚¿ãƒ¼ã«ã¤ã„ã¦ã®æ¦‚è¦ã¯ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

- [DB/SaaSã¨æ¥ç¶šã™ã‚‹](/docs/ja/develop/guides/integration)

<Tabs>
  <Tab title="ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆ">
    <Steps>
      <Step title="Connectorã‚’ä½œæˆã™ã‚‹">
        ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®ã€ŒConnectorsã€ã‚¿ãƒ–ã‚’é¸æŠã—ã€ŒCreateã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã—ã¾ã™ã€‚
        <img src="/assets/images/docs/advanced/connectors/connect-data-platform-connection.png" alt="Connection" />
      </Step>

      <Step title="Snowflakeã®èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã™ã‚‹">
        Snowflakeã§ã¯ï¼“ã¤ã®èªè¨¼æ–¹å¼ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

        Snowflakeã®Server URLã«ã¤ã„ã¦ã¯å…¬å¼ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

        - [ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®æ¥ç¶š](https://docs.snowflake.com/ja/user-guide/organizations-connect)

        ### ç§˜å¯†éµæ–¹å¼ã§æ¥ç¶šã™ã‚‹

        Snowflake (Key Pair)ã‚’é¸æŠã—è¡¨ç¤ºã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒ ã«æ¥ç¶šã™ã‚‹èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

        <img src="/assets/images/docs/advanced/connectors/connect-data-platform-snowflake-kp-create.png" alt="Snowflake Key Pair Connection Create" />

        | é …ç›®å            | èª¬æ˜                                      | å¿…é ˆ  | ä¾‹                            |
        |-------------------|-------------------------------------------|-------|-------------------------------|
        | `Server`           | Snowflakeæ¨™æº–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆURL      | âœ…    | `https://<ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼>.<ãƒªãƒ¼ã‚¸ãƒ§ãƒ³>.<ã‚¯ãƒ©ã‚¦ãƒ‰>.snowflakecomputing.com`                |
        | `Username`           | ãƒ¦ãƒ¼ã‚¶ãƒ¼å    | âœ…    | `DEMO_USER`                       |
        | `Private Key`       | ç§˜å¯†éµ              | âœ…    | `-----BEGIN PRIVATE KEY-----`                |
        | `Passphrase`       | ç§˜å¯†éµã®ãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚º    |    | `passphrase`                    |

        ç§˜å¯†éµã®ä½œæˆã«ã¤ã„ã¦ã¯å…¬å¼ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

        - [ã‚­ãƒ¼ãƒšã‚¢èªè¨¼ã¨ã‚­ãƒ¼ãƒšã‚¢ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³](https://docs.snowflake.com/ja/user-guide/key-pair-auth)


        ### User/Passwordã§æ¥ç¶šã™ã‚‹

        Snowflake (user / password)ã‚’é¸æŠã—è¡¨ç¤ºã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒ ã«æ¥ç¶šã™ã‚‹èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

        <Warning>ï¼’æ®µéšèªè¨¼ã‚’æœ‰åŠ¹ã«ã—ã¦ã„ã‚‹å ´åˆã¯éƒ½åº¦æ‰¿èªãŒå¿…è¦ãªãŸã‚ã”æ³¨æ„ãã ã•ã„ã€‚</Warning>

        <img src="/assets/images/docs/advanced/connectors/connect-data-platform-snowflake-ip-create.png" alt="Snowflake ID Password Connection Create" />

        | é …ç›®å            | èª¬æ˜                                      | å¿…é ˆ  | ä¾‹                            |
        |-------------------|-------------------------------------------|-------|-------------------------------|
        | `Server`           | Snowflakeæ¨™æº–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆURL      | âœ…    | `https://<ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼>.<ãƒªãƒ¼ã‚¸ãƒ§ãƒ³>.<ã‚¯ãƒ©ã‚¦ãƒ‰>.snowflakecomputing.com`                |
        | `Username`           | ãƒ¦ãƒ¼ã‚¶ãƒ¼å    | âœ…    | `DEMO_USER`                       |
        | `Password`       | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰              | âœ…    | `password`                |

        ### OAuthã§æ¥ç¶šã™ã‚‹

        Snowflake (OAuth)ã‚’é¸æŠã—è¡¨ç¤ºã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒ ã«æ¥ç¶šã™ã‚‹èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

        <img src="/assets/images/docs/advanced/connectors/connect-data-platform-snowflake-oauth-create.png" alt="Snowflake OAuth Connection Create" />

        | é …ç›®å            | èª¬æ˜                                      | å¿…é ˆ  | ä¾‹                            |
        |-------------------|-------------------------------------------|-------|-------------------------------|
        | `Server`           | Snowflakeæ¨™æº–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆURL      | âœ…    | `https://<ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚±ãƒ¼ã‚¿ãƒ¼>.<ãƒªãƒ¼ã‚¸ãƒ§ãƒ³>.<ã‚¯ãƒ©ã‚¦ãƒ‰>.snowflakecomputing.com`                |
        | `Client Id`           | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID    | âœ…    | `CLIENT_ID`                       |
        | `Client Secret`       | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ              | âœ…    | `CLIENT_SECRET`                |

        ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ä½œæˆã«ã¤ã„ã¦ã¯å…¬å¼ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

        - [ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”¨ã®Snowflake OAuth ã®æ§‹æˆ](https://docs.snowflake.com/ja/user-guide/oauth-custom)


        å…¥åŠ›å¾ŒCreateãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ä½œæˆãŒå®Œäº†ã—ã¾ã™ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä¸å‚™ãŒã‚ã‚‹å ´åˆã¯ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŸã‚æ¥ç¶šå†…å®¹ãŒæ­£ã—ã„ã‹å†åº¦ã”ç¢ºèªãã ã•ã„ã€‚

      </Step>
      <Step title="ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹">
        ä½œæˆãŒæˆåŠŸã™ã‚‹ã¨ä¸€è¦§è¡¨ç¤ºã‹ã‚‰ã‚³ãƒã‚¯ã‚¿ãƒ¼åã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¢ã‚¤ã‚³ãƒ³æ¨ªã®æ–‡å­—åˆ—ãŒ`connection_name`ã§ã™ã€‚ã“ã‚Œã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã‚³ãƒ¼ãƒ‰ä¸Šã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šå¯èƒ½ã§ã™ã€‚

        <img src="/assets/images/docs/advanced/connectors/connect-data-platform-snowflake-complete.png" alt="Snowflake Connection Create Complete" />

        SQLã¾ãŸã¯Pythonã®ã‚³ãƒ¼ãƒ‰ã«ä½œæˆã—ãŸã‚³ãƒã‚¯ã‚¿ãƒ¼åã‚’å…¥åŠ›ã—ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚
        <CodeGroup>
        ```sql SQL
        {{
            config(
                connection="connection_name"
            )
        }}

        select * from table_name
        ```

        ```python Python
        import morph
        from morph import MorphGlobalContext
        from morph_lib.database import execute_sql


        @morph.func
        def main(context: MorphGlobalContext):
            df = execute_sql(
                sql="SELECT * from table_name"
                connection="connection_name"
            )
            return df
        ```
        </CodeGroup>
      </Step>
    </Steps>

  </Tab>
  <Tab title="ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆ">
    <Info>ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã§ã¯ç¾åœ¨User/Passwordæ–¹å¼ã®ã¿ãŒã‚³ãƒãƒ³ãƒ‰ã§ä½œæˆå¯èƒ½ã§ã™ã€‚ãã‚Œä»¥å¤–ã®æ–¹å¼ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆã‚’ã”åˆ©ç”¨ã„ãŸã ãã‹ã€ç›´æ¥~/.morph/connections.ymlã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</Info>

    <Steps>
      <Step title="morph initã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹">
        `morph init`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦DBã®æ¥ç¶šæƒ…å ±ã‚’`~/.morph/connections.yml`ã«ä¿å­˜ã—ã¾ã™ã€‚
        ```bash Shell
        morph init
        ```

        <Warning>
        morphãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œãªã£ã¦ã„ãªã„å ´åˆã¯äº‹å‰ã«ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‹ã‚‰ãŠé€²ã¿ãã ã•ã„ã€‚
        ```bash shell
        pip install morph-data
        ```
        </Warning>

        å¯¾è©±å¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç¨®é¡ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§Snowflake (User/Password)ã‚’é¸æŠã—ã¾ã™ã€‚
        ```bash Shell
        Select your database type:
        1. PostgreSQL
        2. MySQL
        3. Redshift
        4. SQLServer
        5. Snowflake (User/Password)
        6. BigQuery (Service Account)
        Enter the number corresponding to your database type: 5

        Snowflake (User/Password) selected.
        ```

        ç¶šã„ã¦èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™ã€‚`slug`ã¯ã‚³ãƒã‚¯ã‚¿ãƒ¼åã¨ã—ã¦æ‰±ã†ã‚‚ã®ã§ã€ã“ã®åå‰ã‚’SQLã‚‚ã—ãã¯Pythonã§æŒ‡å®šã—ã¾ã™ã€‚

        ä»¥ä¸‹ã®å…¥åŠ›ä¾‹ã¯å®Ÿéš›ã«æ¥ç¶šã§ãã‚‹å€¤ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚
        ```bash shell
        Create a slug for your connection: snowflake-connection
        Enter your Snowflake account: https://~
        Enter your Snowflake database name: DEMO
        Enter your Snowflake username: DEMO_USER
        Enter your Snowflake password: password
        Enter your Snowflake role name: DEMO_ROLE
        Enter your Snowflake warehouse: DEMO_WAREHOUSE
        Enter your Snowflake schema name (optional):
        ```

        èªè¨¼æƒ…å ±ã®ä¿å­˜ãŒå®Œäº†ã™ã‚‹ã¨ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
        ```bash shell
        Successfully initialized! ğŸ‰
        You can edit your connection details in `path_to_connections.yml`
        ```

        `connections.yml`ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»–ã®ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’ä½œæˆã—ãŸå ´åˆã¯`connections`ä»¥ä¸‹ã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚
        ```bash shell
        cat ~/.morph/connections.yml
        ```

        ```yaml
        connections:
          snowflake-connection:
            account: https://~
            database: DEMO
            method: snowflake_user_password
            password: password
            role: DEMO_ROLE
            schema_: ''
            type: snowflake
            user: DEMO_USER
            warehouse: DEMO_WAREHOUSE
        ```
      </Step>
      <Step title="ã‚³ãƒ¼ãƒ‰ä¸Šã§ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’ä½¿ã„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹">
        SQLã¾ãŸã¯Pythonã®ã‚³ãƒ¼ãƒ‰ã«ä½œæˆã—ãŸã‚³ãƒã‚¯ã‚¿ãƒ¼åã‚’å…¥åŠ›ã—ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚
        <CodeGroup>
        ```sql SQL
        {{
            config(
                connection="connection_name"
            )
        }}

        select * from table_name
        ```

        ```python Python
        import morph
        from morph import MorphGlobalContext
        from morph_lib.database import execute_sql


        @morph.func
        def main(context: MorphGlobalContext):
            df = execute_sql(
                sql="SELECT * from table_name"
                connection="connection_name"
            )
            return df
        ```
        </CodeGroup>
      </Step>
    </Steps>

    <Warning>
        å®Ÿéš›ã«ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’æŒ‡å®šã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ãŸå ´åˆã®å„ªå…ˆé †ä½ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
        ã¾ãŸ`morph deploy`ã‚’è¡Œãªã£ãŸç’°å¢ƒã§ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆã§ä½œæˆã—ãŸã‚³ãƒã‚¯ã‚¿ãƒ¼ã®ã¿ãŒä½¿ç”¨å¯èƒ½ãªãŸã‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
        1. ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã®`~/.morph/connections.yml`ã«è¨˜è¼‰ã•ã‚ŒãŸã‚³ãƒã‚¯ã‚¿ãƒ¼
        2. ã‚¯ãƒ©ã‚¦ãƒ‰ã§ç™»éŒ²ã•ã‚ŒãŸã‚³ãƒã‚¯ã‚¿ãƒ¼
    </Warning>

    ### ç§˜å¯†éµãƒ»OAuthã®å ´åˆã®è¨˜è¿°æ–¹æ³•

    ç§˜å¯†éµã€ã‚‚ã—ãã¯OAuthã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯`~/.morph/connections.yml`ã‚’ç›´æ¥ç·¨é›†ã—ã¾ã™ã€‚

    access_tokenã®ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã¯ã‚¯ãƒ©ã‚¦ãƒ‰ç‰ˆã®æ©Ÿèƒ½ã®ãŸã‚ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯è¨˜è¼‰ã—ãŸã‚‚ã®ãŒå¸¸æ™‚ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

    **ç§˜å¯†éµæ–¹å¼**
    ```yml
    connections:
      snowflake-key-pair-connection
        type: snowflake # å›ºå®š
        method: snowflake_key_pair # å›ºå®š
        account: str
        username: str
        database: str
        key_pair: str
        role: str
        warehouse: str
        schema_: str # ä»»æ„
        passphrase: str # ä»»æ„
        access_token: str # ä»»æ„
    ```

    **OAuthæ–¹å¼**
    ```yml
    connections:
      snowflake-oauth-connection
        type: snowflake # å›ºå®š
        method: snowflake_oauth # å›ºå®š
        account: str
        database: str
        refresh_token: str
        client_id: str
        client_secret: str
        redirect_uri: str
        role: str
        warehouse: str
        code_verifier: str
        schema_: str # ä»»æ„
        access_token: str # ä»»æ„
    ```

  </Tab>
</Tabs>